<ion-header>
  <ion-toolbar>
    <ion-title>{{ 'PROFILE.TITLE' | translate }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- Профіль користувача -->
  <div class="profile-header">
    <ion-avatar>
      <img src="../../../assets/images/avatar/4.jpg" />
    </ion-avatar>
    <h2>{{userName}}</h2>
    <div class="points">
      <ion-icon name="trophy"></ion-icon>
      <span>{{totalPoints}} {{ 'PROFILE.POINTS' | translate }}</span>
    </div>
  </div>

  <!-- Основні налаштування -->
  <ion-list>
    <ion-item-group>
      <ion-item-divider>
        <ion-label>{{ 'PROFILE.PERSONAL_DATA' | translate }}</ion-label>
      </ion-item-divider>
      
      <ion-item button (click)="editProfile()">
        <ion-icon slot="start" name="person-outline"></ion-icon>
        <ion-label>
          <h3>{{ 'PROFILE.EDIT_PROFILE' | translate }}</h3>
          <p>{{ 'PROFILE.CHANGE_DATA' | translate }}</p>
        </ion-label>
        <ion-icon slot="end" name="chevron-forward"></ion-icon>
      </ion-item>
    </ion-item-group>

    <!-- Інтеграції -->
    <ion-item-group>
      <ion-item-divider>
        <ion-label>{{ 'PROFILE.INTEGRATIONS' | translate }}</ion-label>
      </ion-item-divider>
      
      <ion-item button (click)="connectDevice('garmin')">
        <ion-icon slot="start" name="watch-outline"></ion-icon>
        <ion-label>
          <h3>Garmin Connect</h3>
          <p>{{isConnected.garmin ? ('PROFILE.CONNECTED' | translate) : ('PROFILE.NOT_CONNECTED' | translate)}}</p>
        </ion-label>
        <ion-icon slot="end" [name]="isConnected.garmin ? 'checkmark-circle' : 'add-circle-outline'"></ion-icon>
      </ion-item>

      <ion-item button (click)="connectDevice('samsung')">
        <ion-icon slot="start" name="watch-outline"></ion-icon>
        <ion-label>
          <h3>Samsung Health</h3>
          <p>{{isConnected.samsung ? ('PROFILE.CONNECTED' | translate) : ('PROFILE.NOT_CONNECTED' | translate)}}</p>
        </ion-label>
        <ion-icon slot="end" [name]="isConnected.samsung ? 'checkmark-circle' : 'add-circle-outline'"></ion-icon>
      </ion-item>

      <ion-item button (click)="connectDevice('apple')">
        <ion-icon slot="start" name="watch-outline"></ion-icon>
        <ion-label>
          <h3>Apple Health</h3>
          <p>{{isConnected.apple ? ('PROFILE.CONNECTED' | translate) : ('PROFILE.NOT_CONNECTED' | translate)}}</p>
        </ion-label>
        <ion-icon slot="end" [name]="isConnected.apple ? 'checkmark-circle' : 'add-circle-outline'"></ion-icon>
      </ion-item>
    </ion-item-group>

    <!-- Дані про здоров'я -->
    <ion-item-group *ngIf="healthData">
      <ion-item-divider>
        <ion-label>{{ 'PROFILE.HEALTH_DATA' | translate }}</ion-label>
        <ion-note slot="end">{{ 'PROFILE.LAST_UPDATE' | translate }}: {{healthData.lastSync | date:'short'}}</ion-note>
      </ion-item-divider>

      <!-- Сон -->
      <ion-item>
        <ion-icon slot="start" name="moon-outline" color="primary"></ion-icon>
        <ion-label>
          <h3>{{ 'PROFILE.SLEEP' | translate }}</h3>
          <p>{{ 'PROFILE.DURATION' | translate }}: {{healthData.sleep.duration / 60 | number:'1.0-1'}} {{ 'PROFILE.HOURS' | translate }}</p>
          <p>{{ 'PROFILE.QUALITY' | translate }}: {{healthData.sleep.quality}}%</p>
        </ion-label>
      </ion-item>

      <!-- Активність -->
      <ion-item>
        <ion-icon slot="start" name="footsteps-outline" color="success"></ion-icon>
        <ion-label>
          <h3>{{ 'PROFILE.ACTIVITY' | translate }}</h3>
          <p>{{ 'PROFILE.STEPS' | translate }}: {{healthData.activity.steps | number}} ({{healthData.activity.distance / 1000 | number:'1.1-1'}} {{ 'PROFILE.KM' | translate }})</p>
          <p>{{ 'PROFILE.ACTIVE_MINUTES' | translate }}: {{healthData.activity.activeMinutes}}</p>
        </ion-label>
      </ion-item>

      <!-- Пульс -->
      <ion-item>
        <ion-icon slot="start" name="heart-outline" color="danger"></ion-icon>
        <ion-label>
          <h3>{{ 'PROFILE.HEART_RATE' | translate }}</h3>
          <p>{{ 'PROFILE.CURRENT' | translate }}: {{healthData.activity.heartRate.current}} {{ 'PROFILE.BPM' | translate }}</p>
          <p>{{ 'PROFILE.AVERAGE' | translate }}: {{healthData.activity.heartRate.average}} {{ 'PROFILE.BPM' | translate }}</p>
        </ion-label>
      </ion-item>

      <!-- Стрес -->
      <ion-item>
        <ion-icon slot="start" name="pulse-outline" color="warning"></ion-icon>
        <ion-label>
          <h3>{{ 'PROFILE.STRESS_LEVEL' | translate }}</h3>
          <p>{{healthData.stress.level}}%</p>
        </ion-label>
      </ion-item>
    </ion-item-group>

    <!-- Налаштування сповіщень -->
    <ion-item-group>
      <ion-item-divider>
        <ion-label>{{ 'PROFILE.NOTIFICATIONS' | translate }}</ion-label>
      </ion-item-divider>
      
      <ion-item>
        <ion-icon name="notifications" slot="start"></ion-icon>
        <ion-label>{{ 'PROFILE.PUSH_NOTIFICATIONS' | translate }}</ion-label>
        <ion-toggle [(ngModel)]="notifications.push" [attr.aria-label]="'PROFILE.PUSH_NOTIFICATIONS' | translate"></ion-toggle>
      </ion-item>

      <ion-item>
        <ion-icon name="time" slot="start"></ion-icon>
        <ion-label>{{ 'PROFILE.REMINDERS' | translate }}</ion-label>
        <ion-toggle [(ngModel)]="notifications.reminders" [attr.aria-label]="'PROFILE.REMINDERS' | translate"></ion-toggle>
      </ion-item>

      <ion-item>
        <ion-icon name="trophy" slot="start"></ion-icon>
        <ion-label>{{ 'PROFILE.ACHIEVEMENTS' | translate }}</ion-label>
        <ion-toggle [(ngModel)]="notifications.achievements" [attr.aria-label]="'PROFILE.ACHIEVEMENTS' | translate"></ion-toggle>
      </ion-item>
    </ion-item-group>
  </ion-list>

  <!-- Кнопка виходу -->
  <ion-button expand="block" color="danger" class="logout-button" (click)="logout()">
    <ion-icon slot="start" name="log-out-outline"></ion-icon>
    {{ 'PROFILE.LOGOUT' | translate }}
  </ion-button>
</ion-content>
